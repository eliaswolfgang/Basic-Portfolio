<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <!-- Meta tag to scale webpage content to the width of its current viewport -->
    <meta name="viewport" content="width-device-width, initial-scale=1">
    <!-- Link to Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- Custom CSS  -->

    <title>Ian Von Fange | Contact</title>
</head>

<body>
    <!-- Consistent header including navbar -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <h1><span class="badge rounded-pill bg-info">Ian Von Fange</span></h1>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link" href="./index.html">About</a>
                    <a class="nav-link" href="./portfolio.html">Portfolio</a>
                    <a class="nav-link active" href="#">Contact</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="row">
            <h1 class="card-title">Contact</h1>
        </div>
        <div class="row">
            <div class="col-lg-8">
                <div class="card bg-dark text-white">
                    <form class="gform" method="POST" data-email="wolfgangvonfange@gmail.com"
                        action="https://script.google.com/macros/s/AKfycbyIJ2AtKpSLjwWWuJbgp4eKRbueHqQW-AsCUHioRNIaAy3Eh88G/exec">
                        <div style="display:none" class="thankyou_message">
                            <h2><em>Thanks</em> for contacting me! I'll be in touch soon!
                            </h2>
                        </div> 
                        <div class="form-group">
                            <label for="formGroupName">Name</label>
                            <input type="text" class="form-control" id="formGroupName" placeholder="John Smith"
                                name="name">
                        </div>
                        <div class="form-group">
                            <label for="formGroupEmail">Email</label>
                            <input type="text" class="form-control" id="formGroupEmail"
                                placeholder="example@example.com" name="email">
                        </div>
                        <div class="form-group">
                            <label for="formGroupMessage">Message</label>
                            <textarea class="form-control" id="formGroupMessage" rows="8" name="message"></textarea>
                        </div>
                        <button class="btn btn-info btn-lg" type="submit">Submit</button>
                    </form>
                </div>
            </div>
        </div>

    </div>

    <!-- Sticky footer including copyright information -->
    <footer class="py-4 bg-light text-black-50">
        <div class="container text-center">
            <span class="text-muted">&copy; Ian Von Fange 2021 | Powered by Bootstrap 4.5</span>
        </div>
    </footer>
    <!-- Links to Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
        integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
        crossorigin="anonymous"></script>
    <script type="text/javascript">
        (function () {
            // get all data in form and return object
            function getFormData(form) {
                var elements = form.elements;
                var honeypot;

                var fields = Object.keys(elements).filter(function (k) {
                    if (elements[k].name === "honeypot") {
                        honeypot = elements[k].value;
                        return false;
                    }
                    return true;
                }).map(function (k) {
                    if (elements[k].name !== undefined) {
                        return elements[k].name;
                        // special case for Edge's html collection
                    } else if (elements[k].length > 0) {
                        return elements[k].item(0).name;
                    }
                }).filter(function (item, pos, self) {
                    return self.indexOf(item) == pos && item;
                });

                var formData = {};
                fields.forEach(function (name) {
                    var element = elements[name];

                    // singular form elements just have one value
                    formData[name] = element.value;

                    // when our element has multiple items, get their values
                    if (element.length) {
                        var data = [];
                        for (var i = 0; i < element.length; i++) {
                            var item = element.item(i);
                            if (item.checked || item.selected) {
                                data.push(item.value);
                            }
                        }
                        formData[name] = data.join(', ');
                    }
                });

                // add form-specific values into the data
                formData.formDataNameOrder = JSON.stringify(fields);
                formData.formGoogleSheetName = form.dataset.sheet || "responses"; // default sheet name
                formData.formGoogleSendEmail
                    = form.dataset.email || ""; // no email by default

                return { data: formData, honeypot: honeypot };
            }

            function handleFormSubmit(event) {  // handles form submit without any jquery
                event.preventDefault();           // we are submitting via xhr below
                var form = event.target;
                var formData = getFormData(form);
                var data = formData.data;

                // If a honeypot field is filled, assume it was done so by a spam bot.
                if (formData.honeypot) {
                    return false;
                }

                disableAllButtons(form);
                var url = form.action;
                var xhr = new XMLHttpRequest();
                xhr.open('POST', url);
                // xhr.withCredentials = true;
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        form.reset();
                        var formElements = form.querySelector(".form-elements")
                        if (formElements) {
                            formElements.style.display = "none"; // hide form
                        }
                        var thankYouMessage = form.querySelector(".thankyou_message");
                        if (thankYouMessage) {
                            thankYouMessage.style.display = "block";
                        }
                    }
                };
                // url encode form data for sending as post data
                var encoded = Object.keys(data).map(function (k) {
                    return encodeURIComponent(k) + "=" + encodeURIComponent(data[k]);
                }).join('&');
                xhr.send(encoded);
            }

            function loaded() {
                // bind to the submit event of our form
                var forms = document.querySelectorAll("form.gform");
                for (var i = 0; i < forms.length; i++) {
                    forms[i].addEventListener("submit", handleFormSubmit, false);
                }
            };
            document.addEventListener("DOMContentLoaded", loaded, false);

            function disableAllButtons(form) {
                var buttons = form.querySelectorAll("button");
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].disabled = true;
                }
            }
        })();
    </script>
</body>

</html>